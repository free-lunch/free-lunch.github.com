<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Linux Memory - Smem &#8211; Free-lunch</title>
<meta name="description" content="

">
<meta name="keywords" content="linux, memory, smem, smemcap">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Linux Memory - Smem">
<meta name="twitter:description" content="

">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/Smem-viewer.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="ko_KR">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux Memory - Smem">
<meta property="og:description" content="

">
<meta property="og:url" content="/linux-memory-smem/">
<meta property="og:site_name" content="Free-lunch">

<meta property="og:image" content="/images/Smem-viewer.jpg">






<link rel="canonical" href="/linux-memory-smem/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Free-lunch Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Free-lunch</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				    <li><a href="/about/" >About Me</a></li>
				
				    
				    <li><a href="/posts/" >Posts</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "/images/Smem-viewer.jpg"
    
  alt="Linux Memory - Smem feature image">
  
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo.jpg" class="bio-photo" alt="Jeonghun Jang bio photo">


  <h3 itemprop="name">Jeonghun Jang</h3>
  <p>Describe your self.</p>
  
  
  <a href="http://facebook.com/100001610227696" class="author-social" target="_blank"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a>
  
  <a href="http://linkedin.com/in/freelunch" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/free-lunch" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/linux-memory-smem/" rel="bookmark" title="Linux Memory - Smem">Linux Memory - Smem</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <hr />

<h2 id="section">1. 목적</h2>

<p>이 글을 쓰게된 이유는 리눅스에서 프로세스별 메모리 사용량을 파악하기 위해서이다.</p>

<hr />

<h2 id="section-1">2. 용어</h2>
<p>프로세스의 메모리를 완벽하게 측정하는 방법은 없다.
 측정하는 여러 방식 중에서 가장 적합하다고 생각되는 것을 선택을 해야한다. 
그러기 위해서는 아래와 같은 방식들을 이해를 해야한다.</p>

<ul>
  <li>VSS : 프로세스와 관계되는 모든 Virtual 메모리의 크기</li>
  <li>RSS : 프로세스와 관계되는 물리적 페이지의 수
(Shared memory를 중복 포함하여 계산되서 실제보다 크게 측정</li>
  <li>USS : shared memroy를 불포함</li>
  <li>PSS : Shared memory를 사용하는 프로세스의 수로 shared memory를 나누어서 포함</li>
</ul>

<p>참고 : <a href="http://ecogeo.tistory.com/255">http://ecogeo.tistory.com/255</a></p>

<p>기본적으로 free나 top을 통해 나오는 메모리 값은 RSS나 VSS이다. 
즉, 다시말해 free나 top을 통해 나오는 메모리는 실제 사용메모리보다 크게 나온다는 얘기이다.
정확한 데이터를 위해서는 USS나 PSS를 사용해야 한다. 
여기서는 PSS를 선택하여 계산하도록 한다.</p>

<hr />

<h2 id="tool">3. Tool</h2>
<p>우리가 필요한 정보들은 아래에 모두 존재한다.</p>

<p>/proc/$pid/cmdline</p>

<p>/proc/$pid/smaps</p>

<p>/proc/$pid/stat</p>

<p>/proc/meminfo</p>

<p>/proc/version</p>

<p>하지만 모든 프로세스를 일일히 볼수는 없다. smem이라는 툴을 사용하도록 하자.</p>

<p>Ubuntu 기준으로 apt-get install smem으로 설치가 가능하다.
smem은 현재 기준으로 결과를 보여준다.
특정 시점을 캡쳐하고 싶으면, smemcap을 이용하도록 하자.
smemcap은 /proc/의 data를 tar로 묶어준다.
설치는 위와 동일하게 apt-get install smemcap으로 가능하다.
소스코드가 필요하다면 아래 site로 go
<a href="https://www.selenic.com/smem/">https://www.selenic.com/smem/</a></p>

<h3 id="usage">Usage</h3>

<table>
  <tbody>
    <tr>
      <td>Show basic process information</td>
      <td>smem</td>
    </tr>
    <tr>
      <td>Show library-oriented view</td>
      <td>smem -m</td>
    </tr>
    <tr>
      <td>Show user-oriented view</td>
      <td>smem -u</td>
    </tr>
    <tr>
      <td>Show system view</td>
      <td>smem -R 4G -K /path/to/vmlinux -w</td>
    </tr>
    <tr>
      <td>Show totals and percentages</td>
      <td>smem -t -p</td>
    </tr>
    <tr>
      <td>Show different columns</td>
      <td>smem -c “name user pss”</td>
    </tr>
    <tr>
      <td>Sort by reverse RSS</td>
      <td>smem -s rss -r</td>
    </tr>
    <tr>
      <td>Show processes filtered by mapping</td>
      <td>smem -M libxml</td>
    </tr>
    <tr>
      <td>Show mappings filtered by process</td>
      <td>smem -m -P [e]volution</td>
    </tr>
    <tr>
      <td>Read data from capture tarball</td>
      <td>smem –source capture.tar.gz</td>
    </tr>
    <tr>
      <td>Show a bar chart labeled by pid</td>
      <td>smem –bar pid -c “pss uss”</td>
    </tr>
    <tr>
      <td>Show a pie chart of RSS labeled by name</td>
      <td>smem –pie name -s rss</td>
    </tr>
  </tbody>
</table>


      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/linux-memory-smem/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/linux-memory-smem/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/linux-memory-smem/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Linux Memory - Smem</strong> was published on <time datetime="2016-01-06T11:01:19+09:00">January 06, 2016</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/sublime-text-3-configuration/" title="Sublime Text 3 - Configuration">Sublime Text 3 - Configuration</a></li>
    
      <li><a href="/c-lambda/" title="C++ Lambda">C++ Lambda</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2016 Jeonghun Jang. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
