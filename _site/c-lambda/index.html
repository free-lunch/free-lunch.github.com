<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>C++ Lambda &#8211; Free-lunch</title>
<meta name="description" content="

">
<meta name="keywords" content="C++, lambda">


<!-- Twitter Cards -->
<meta name="twitter:title" content="C++ Lambda">
<meta name="twitter:description" content="

">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/lambda_expression.png">

<!-- Open Graph -->
<meta property="og:locale" content="ko_KR">
<meta property="og:type" content="article">
<meta property="og:title" content="C++ Lambda">
<meta property="og:description" content="

">
<meta property="og:url" content="/c-lambda/">
<meta property="og:site_name" content="Free-lunch">

<meta property="og:image" content="/images/lambda_expression.png">






<link rel="canonical" href="/c-lambda/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Free-lunch Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Free-lunch</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				    <li><a href="/posts/" >Sample Posts</a></li>
				
				    
				    <li><a href="/theme-setup/" >Theme Setup</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "/images/lambda_expression.png"
    
  alt="C++ Lambda feature image">
  
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo.jpg" class="bio-photo" alt="Jeonghun Jang bio photo">


  <h3 itemprop="name">Jeonghun Jang</h3>
  <p>Describe your self.</p>
  
  
  <a href="http://facebook.com/100001610227696" class="author-social" target="_blank"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a>
  
  <a href="http://linkedin.com/in/freelunch" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/free-lunch" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/c-lambda/" rel="bookmark" title="C++ Lambda">C++ Lambda</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <hr />

<h2 id="what-is-lambda">What is lambda?</h2>
<p>간단하게 람다는 익명 함수이다.
람다에 대해서는 다들 잘 알고 있을테니, 문법에 대해 정리하도록 하자.</p>

<h2 id="syntax-of-lambda">1. Syntax of lambda</h2>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="mf">1.</span> <span class="p">[</span> <span class="n">capture</span><span class="o">-</span><span class="n">list</span> <span class="p">]</span> <span class="p">(</span> <span class="n">params</span> <span class="p">)</span> <span class="k">mutable</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="n">exception</span> <span class="n">attribute</span> <span class="o">-&gt;</span> <span class="n">ret</span> <span class="p">{</span> <span class="n">body</span> <span class="p">}</span>
<span class="mf">2.</span> <span class="p">[</span> <span class="n">capture</span><span class="o">-</span><span class="n">list</span> <span class="p">]</span> <span class="p">(</span> <span class="n">params</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ret</span> <span class="p">{</span> <span class="n">body</span> <span class="p">}</span>
<span class="mf">3.</span> <span class="p">[</span> <span class="n">capture</span><span class="o">-</span><span class="n">list</span> <span class="p">]</span> <span class="p">(</span> <span class="n">params</span> <span class="p">)</span> <span class="p">{</span> <span class="n">body</span> <span class="p">}</span>
<span class="mf">4.</span> <span class="p">[</span> <span class="n">capture</span><span class="o">-</span><span class="n">list</span> <span class="p">]</span> <span class="p">{</span> <span class="n">body</span> <span class="p">}</span></code></pre></figure>

<blockquote>
  <ol>
    <li>Full declaration</li>
    <li>Const lamda : 캡쳐된 object를 수정할 수 없음</li>
    <li>Omitted trailing-return-type : return statements에 의해 자동 추론</li>
    <li>Omitted parameter list : function이 argument를 가지지 않는 케이스</li>
  </ol>
</blockquote>

<p>아마 주로 3번 형태를 많이 사용하게 될 것이며, capture-list에 대해 간단히 정리하도록 하자
(params는 일반 함수 parameter와 동일하게 기재하면 된다). 
정리하기 앞서 lambda의 간단한 사용예제를 보도록 하자.</p>

<h3 id="example">1.1 Example</h3>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;vector&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;functional&gt;
</span> 
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">c</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">remove_if</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">c</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">;</span> <span class="p">}),</span> <span class="n">c</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
 
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"c: "</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">for_each</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">c</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[](</span><span class="kt">int</span> <span class="n">i</span><span class="p">){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">' '</span><span class="p">;</span> <span class="p">});</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<h3 id="result">1.2 Result</h3>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="nl">c:</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> </code></pre></figure>

<p>위 예제는 vector에서 입력받은 인자보다 작은 값을 가진 요소들을 vector에서 삭제하는 예제이다. 
std::remove_if는 범위에서 조건에 해당되는 값을 삭제하는 함수이다. 
조건을 판별하는 인자로 function object or function pointer를 받게되는데, 여기에 lambda를 사용하였다. 
(remove_if라는 함수는 처음 보았네;; 자세한 내용은 http://www.cplusplus.com/reference/algorithm/remove_if/ 참조) 
이제 본론으로 Post를 쓰게 된 capture-list를 정리하도록 하자.</p>

<hr />

<h2 id="capture-list">2. Capture-list</h2>
<p>Capture-list를 사용하면, lambda가 있는 scope 영역의 변수를 원하는 방식으로 캡쳐할 수 있다.
사용할 수 있는 형태로는 아래와 같다.</p>

<h3 id="syntax-of-capture-list">2.1 syntax of capture-list</h3>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="mf">1.</span> <span class="n">identifier</span>
<span class="mf">2.</span> <span class="n">identifier</span> <span class="p">...</span>	
<span class="mf">3.</span> <span class="n">identifier</span> <span class="n">initializer</span><span class="p">(</span><span class="n">C</span><span class="o">++</span><span class="mi">14</span><span class="p">)</span>
<span class="mf">4.</span> <span class="o">&amp;</span> <span class="n">identifier</span>	
<span class="mf">5.</span> <span class="o">&amp;</span> <span class="n">identifier</span> <span class="p">...</span>	
<span class="mf">6.</span> <span class="o">&amp;</span> <span class="n">identifier</span> <span class="n">initializer</span><span class="p">(</span><span class="n">C</span><span class="o">++</span><span class="mi">14</span><span class="p">)</span>
<span class="mf">7.</span> <span class="k">this</span>	
<span class="mf">8.</span> <span class="o">&amp;</span>
<span class="mf">9.</span> <span class="o">=</span></code></pre></figure>

<blockquote>
  <ol>
    <li>by value</li>
    <li>by value and pack expansion(가변인자)</li>
    <li>by value and initializer(초기화 가능)</li>
    <li>by reference</li>
    <li>by reference and pack expansion</li>
    <li>by reference and initializer</li>
    <li>this copy</li>
    <li>capture all variable in scope by reference</li>
    <li>capture all variable in scope by value</li>
  </ol>
</blockquote>

<p>정리를 해보자면 by  reference이냐 by value이냐가 가장 중요하며,
부가적으로 pack expansion와 initializer 지원여부이다.
참고적으로 ,를 통해 여러 개의 변수를 가져올 수 있으며 []와 같이 capture를 하지 않을 수도 있다.
(ex. [a, &amp;b])</p>

<h3 id="section">2.2 주의사항</h3>
<p>this와 reference의 사용은 잘 주의한 뒤 사용을 해야한다. 
reference의 의도치 않은 사용에 대해 알아보자.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">make_func</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="k">auto</span> <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="p">};</span> <span class="c1">//(1)
</span>  <span class="c1">//auto f = [&amp;x]{ std::cout &lt;&lt; x &lt;&lt; std::endl; }; //(2)
</span>  <span class="k">return</span> <span class="n">f</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">auto</span> <span class="n">func</span> <span class="o">=</span> <span class="n">make_func</span><span class="p">();</span>
  <span class="n">func</span><span class="p">();</span>
<span class="p">}</span></code></pre></figure>

<p>위 코드는 lambda를 사용하여 x를 출력하는 간단한 내용이다.<br />
하지만 2번과 같이  reference를 사용한다면 10이 아닌 gabage 값이 찍힐 것이다.
왜냐하면 x의 scope는 make_func가 끝나는 시점에서 종료되기 때문이다.</p>

<p>마지막으로 ,를 사용하여 여러 개의 변수를 사용하는 예제에서 주의해야 될점을 알아보자</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">struct</span> <span class="n">S2</span> <span class="p">{</span> <span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">);</span> <span class="p">};</span>
<span class="kt">void</span> <span class="n">S2</span><span class="o">::</span><span class="n">f</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">[</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="p">{};</span> <span class="c1">// ok
</span>    <span class="p">[</span><span class="o">&amp;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">]</span> <span class="p">{};</span> <span class="c1">// error: i preceded by &amp; when &amp; is the default
</span>    <span class="p">[</span><span class="o">=</span><span class="p">,</span> <span class="k">this</span><span class="p">]</span> <span class="p">{};</span> <span class="c1">// error: this when = is the default
</span>    <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="p">{};</span> <span class="c1">// error: i repeated
</span><span class="p">}</span></code></pre></figure>

<p>2번째 구문은 &amp;로 이미 모든 variable이 by reference로 capture 됐기 때문에 중복이라 에러
3번째도 =로 모든 variable들이 by value로 capture되어 중복이라 에러
4번째로 동일한 variable을 캡쳐하기에 에러
여기서 중요한 것은 중복해서 capture를 하면 안된다는 점이다. 
이러한 점을 유의해서 사용해야 할 것</p>

<hr />

<h2 id="reference">Reference</h2>

<p><a href="http://en.cppreference.com/w/cpp/language/lambda">http://en.cppreference.com/w/cpp/language/lambda</a></p>

<p><a href="http://devsw.tistory.com/197">http://devsw.tistory.com/197</a></p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/c-lambda/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/c-lambda/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/c-lambda/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>C++ Lambda</strong> was published on <time datetime="2015-12-28T13:48:10+09:00">December 28, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <footer>
    

<span>&copy; 2016 Jeonghun Jang. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
